<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zoubei.mapper.tourist.TouristMapper" >
  <resultMap id="BaseResultMap" type="com.zoubei.entity.tourist.Tourist" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 11:14:47 CST 2018.
    -->
    <id column="tourist_id" property="touristId" jdbcType="INTEGER" />
    <result column="tourist_nickname" property="touristNickname" jdbcType="VARCHAR" />
    <result column="tourist_password" property="touristPassword" jdbcType="VARCHAR" />
    <result column="tourist_realname" property="touristRealname" jdbcType="VARCHAR" />
    <result column="tourist_sex" property="touristSex" jdbcType="VARCHAR" />
    <result column="tourist_birth" property="touristBirth" jdbcType="DATE" />
    <result column="tourist_cardid" property="touristCardid" jdbcType="VARCHAR" />
    <result column="tourist_phone" property="touristPhone" jdbcType="VARCHAR" />
    <result column="area_id" property="areaId" jdbcType="INTEGER" />
    <result column="tourist_address" property="touristAddress" jdbcType="VARCHAR" />
    <result column="tourist_image" property="touristImage" jdbcType="VARCHAR" />
    <result column="tourist_content" property="touristContent" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 11:14:47 CST 2018.
    -->
    tourist_id, tourist_nickname, tourist_password, tourist_realname, tourist_sex, tourist_birth, 
    tourist_cardid, tourist_phone, area_id, tourist_address, tourist_image, tourist_content
  </sql>
  
  <!-- 登录 -->
  <select id="selectTourist" parameterType="com.zoubei.entity.tourist.Tourist" resultMap="BaseResultMap">
  	select 
  	 <include refid="Base_Column_List" />
  	from tra_tourist where tourist_nickname = #{touristNickname}
  </select>
  
  <!-- 注册 -->
  <insert id="insertRegister" parameterType="com.zoubei.entity.tourist.Tourist">
  	insert into tra_tourist(tourist_nickname,tourist_password) values(#{touristNickname},#{touristPassword})
  </insert>
  
 <!--  根据id查询游客信息 -->
  <select id="selectToutistList" parameterType="int" resultMap="BaseResultMap">
  	select 
  	<include refid="Base_Column_List" />
  	from tra_tourist where  tourist_id =#{touristId}
  </select>
  
  <!-- 修改个人中心信息 -->
  <update id="updateTour" parameterType="com.zoubei.entity.tourist.Tourist">
  	update tra_tourist set
  		tourist_nickname = #{touristNickname,jdbcType=VARCHAR},
      	tourist_realname = #{touristRealname,jdbcType=VARCHAR},
      	tourist_sex = #{touristSex,jdbcType=VARCHAR},
     	tourist_birth = #{touristBirth,jdbcType=VARCHAR},
      	tourist_phone = #{touristPhone,jdbcType=VARCHAR},
      	tourist_cardid = #{touristCardid,jdbcType=VARCHAR},
      	tourist_address = #{touristAddress,jdbcType=VARCHAR},
      	tourist_content = #{touristContent,jdbcType=VARCHAR}
      where tourist_id = #{touristId,jdbcType=INTEGER}
  </update>
  
  <!-- 	修改个人中心图片	 -->
  <update id="updateTuPian" parameterType="com.zoubei.entity.tourist.Tourist">
  		update tra_tourist set
  			tourist_image = #{touristImage,jdbcType=VARCHAR}
  		where tourist_id = #{touristId,jdbcType=INTEGER} 
  </update>
  
 <!--  查询游客所有信息 -->
  <select id="selectTouristByList" resultMap="BaseResultMap">
  	select 
  		<include refid="Base_Column_List" />
  	from tra_tourist
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 11:14:47 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from tra_tourist
    where tourist_id = #{touristId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 11:14:47 CST 2018.
    -->
    delete from tra_tourist
    where tourist_id = #{touristId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.zoubei.entity.tourist.Tourist" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 11:14:47 CST 2018.
    -->
    insert into tra_tourist (tourist_id, tourist_nickname, tourist_password, 
      tourist_realname, tourist_sex, tourist_birth, 
      tourist_cardid, tourist_phone, area_id, 
      tourist_address, tourist_image, tourist_content
      )
    values (#{touristId,jdbcType=INTEGER}, #{touristNickname,jdbcType=VARCHAR}, #{touristPassword,jdbcType=VARCHAR}, 
      #{touristRealname,jdbcType=VARCHAR}, #{touristSex,jdbcType=VARCHAR}, #{touristBirth,jdbcType=DATE}, 
      #{touristCardid,jdbcType=VARCHAR}, #{touristPhone,jdbcType=VARCHAR}, #{areaId,jdbcType=INTEGER}, 
      #{touristAddress,jdbcType=VARCHAR}, #{touristImage,jdbcType=VARCHAR}, #{touristContent,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.zoubei.entity.tourist.Tourist" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 11:14:47 CST 2018.
    -->
    insert into tra_tourist
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="touristId != null" >
        tourist_id,
      </if>
      <if test="touristNickname != null" >
        tourist_nickname,
      </if>
      <if test="touristPassword != null" >
        tourist_password,
      </if>
      <if test="touristRealname != null" >
        tourist_realname,
      </if>
      <if test="touristSex != null" >
        tourist_sex,
      </if>
      <if test="touristBirth != null" >
        tourist_birth,
      </if>
      <if test="touristCardid != null" >
        tourist_cardid,
      </if>
      <if test="touristPhone != null" >
        tourist_phone,
      </if>
      <if test="areaId != null" >
        area_id,
      </if>
      <if test="touristAddress != null" >
        tourist_address,
      </if>
      <if test="touristImage != null" >
        tourist_image,
      </if>
      <if test="touristContent != null" >
        tourist_content,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="touristId != null" >
        #{touristId,jdbcType=INTEGER},
      </if>
      <if test="touristNickname != null" >
        #{touristNickname,jdbcType=VARCHAR},
      </if>
      <if test="touristPassword != null" >
        #{touristPassword,jdbcType=VARCHAR},
      </if>
      <if test="touristRealname != null" >
        #{touristRealname,jdbcType=VARCHAR},
      </if>
      <if test="touristSex != null" >
        #{touristSex,jdbcType=VARCHAR},
      </if>
      <if test="touristBirth != null" >
        #{touristBirth,jdbcType=DATE},
      </if>
      <if test="touristCardid != null" >
        #{touristCardid,jdbcType=VARCHAR},
      </if>
      <if test="touristPhone != null" >
        #{touristPhone,jdbcType=VARCHAR},
      </if>
      <if test="areaId != null" >
        #{areaId,jdbcType=INTEGER},
      </if>
      <if test="touristAddress != null" >
        #{touristAddress,jdbcType=VARCHAR},
      </if>
      <if test="touristImage != null" >
        #{touristImage,jdbcType=VARCHAR},
      </if>
      <if test="touristContent != null" >
        #{touristContent,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.zoubei.entity.tourist.Tourist" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 11:14:47 CST 2018.
    -->
    update tra_tourist
    <set >
      <if test="touristNickname != null" >
        tourist_nickname = #{touristNickname,jdbcType=VARCHAR},
      </if>
      <if test="touristPassword != null" >
        tourist_password = #{touristPassword,jdbcType=VARCHAR},
      </if>
      <if test="touristRealname != null" >
        tourist_realname = #{touristRealname,jdbcType=VARCHAR},
      </if>
      <if test="touristSex != null" >
        tourist_sex = #{touristSex,jdbcType=VARCHAR},
      </if>
      <if test="touristBirth != null" >
        tourist_birth = #{touristBirth,jdbcType=DATE},
      </if>
      <if test="touristCardid != null" >
        tourist_cardid = #{touristCardid,jdbcType=VARCHAR},
      </if>
      <if test="touristPhone != null" >
        tourist_phone = #{touristPhone,jdbcType=VARCHAR},
      </if>
      <if test="areaId != null" >
        area_id = #{areaId,jdbcType=INTEGER},
      </if>
      <if test="touristAddress != null" >
        tourist_address = #{touristAddress,jdbcType=VARCHAR},
      </if>
      <if test="touristImage != null" >
        tourist_image = #{touristImage,jdbcType=VARCHAR},
      </if>
      <if test="touristContent != null" >
        tourist_content = #{touristContent,jdbcType=VARCHAR},
      </if>
    </set>
    where tourist_id = #{touristId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.zoubei.entity.tourist.Tourist" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Apr 15 11:14:47 CST 2018.
    -->
    update tra_tourist
    set tourist_nickname = #{touristNickname,jdbcType=VARCHAR},
      tourist_password = #{touristPassword,jdbcType=VARCHAR},
      tourist_realname = #{touristRealname,jdbcType=VARCHAR},
      tourist_sex = #{touristSex,jdbcType=VARCHAR},
      tourist_birth = #{touristBirth,jdbcType=DATE},
      tourist_cardid = #{touristCardid,jdbcType=VARCHAR},
      tourist_phone = #{touristPhone,jdbcType=VARCHAR},
      area_id = #{areaId,jdbcType=INTEGER},
      tourist_address = #{touristAddress,jdbcType=VARCHAR},
      tourist_image = #{touristImage,jdbcType=VARCHAR},
      tourist_content = #{touristContent,jdbcType=VARCHAR}
    where tourist_id = #{touristId,jdbcType=INTEGER}
  </update>
  
  
  <resultMap id="getTouristResultMap" type="com.zoubei.entity.tourist.Tourist" >
    <id column="tourist_id" property="touristId" jdbcType="INTEGER" />
    <result column="tourist_nickname" property="touristNickname" jdbcType="VARCHAR" />
    <result column="tourist_password" property="touristPassword" jdbcType="VARCHAR" />
    <result column="tourist_realname" property="touristRealname" jdbcType="VARCHAR" />
    <result column="tourist_sex" property="touristSex" jdbcType="VARCHAR" />
    <result column="tourist_birth" property="touristBirth" jdbcType="DATE" />
    <result column="tourist_cardid" property="touristCardid" jdbcType="VARCHAR" />
    <result column="tourist_phone" property="touristPhone" jdbcType="VARCHAR" />
    <result column="area_id" property="areaId" jdbcType="INTEGER" />
    <result column="tourist_address" property="touristAddress" jdbcType="VARCHAR" />
    <result column="tourist_image" property="touristImage" jdbcType="VARCHAR" />
    <result column="tourist_content" property="touristContent" jdbcType="VARCHAR" />
    	<collection property="scenes" ofType="com.zoubei.entity.scene.Scene">
    		<id column="scene_id" property="sceneId" jdbcType="INTEGER" />
		    <result column="scene_name" property="sceneName" jdbcType="VARCHAR" />
    	</collection>
    	<collection property="senceImgs" ofType="com.zoubei.entity.scene.SceneImg">
    		<id column="img_id" property="imgId" jdbcType="INTEGER" />
		    <result column="scene_id" property="sceneId" jdbcType="INTEGER" />
		    <result column="img_url" property="imgUrl" jdbcType="VARCHAR" />
    	</collection>
  </resultMap>
 <select id="selectTouristListById" parameterType="int" resultMap="getTouristResultMap">
select 
 	*
 	from tra_tourist 
 		left join tra_tourist_scene_collec_rel sc on tra_tourist.tourist_id=sc.tourist_id
 		left join tra_scene on sc.scene_id=tra_scene.scene_id 
 		left join tra_scene_img on tra_scene.scene_id = tra_scene_img.scene_id
	where tra_tourist.tourist_id =#{touristId} GROUP BY tra_scene_img.scene_id
 </select>
 
</mapper>